Departamentos <- st_read('Materiales/Departamentos.gpkg')
# Extracción de coordenadas de los puntos
fires_df <- st_coordinates(fires) %>% as.data.frame()
names(fires_df) <- c('lon','lat')#here
# Aplicación de la estimación
kde <- kde2d(fires_df$lon, fires_df$lat, n = 250, h = .5, lims = c(-86, -65, -19, 0))
kde_raster <- kde %>% raster() %>% crop(peru) %>% mask(peru)
# image(kde)
# plot(peru, add = T, col = NA)
# Convirtiendolo a raster:
#
# kde_raster <- kde %>% raster()
# kde_raster[kde_raster < 0.05] = NA
# kde_raster[kde_raster >= 0.05] = 1
# writeRaster(kde_raster, 'raster2.tif')
# summary(kde_raster %>% getValues() %>% as_vector())
# Mapa con leaflet
# pal <- colorNumeric(c("#0C2C84", "#41B6C4", "#FFFFCC"), values(kde_raster ), na.color = "transparent")
pal <- colorNumeric(c("#3182bd", "#fec44f", "#f03b20"), values(kde_raster), na.color ="transparent")
leaflet() %>%
addTiles() %>%
addRasterImage(kde_raster, colors = pal) %>%
addLegend(pal = pal, values = values(kde_raster),title = "% Incendios") %>%
addPolygons(data = Departamentos,
fillOpacity = 0,
weight = 2,
opacity = 1,
label = ~DEPARTAMEN,
color = "#000000",
group = "Departamentos")
Provincias <- st_read('Materiales/Provincias.gpkg')
Anta <- st_read('Materiales/Anta.gpkg')
names(Provincias)
kde_raster_clas <- kde_raster
kde_raster_clas[kde_raster < 0.05] = NA
kde_raster_clas[kde_raster >= 0.05] = 1
# writeRaster(kde_raster, 'raster2.tif')
leaflet() %>%
addTiles() %>%
addRasterImage(kde_raster_clas, colors = "#f03b20") %>%
# addLegend(pal = pal, values = values(kde_raster),title = "% Incendios") %>%
addPolygons(data = Provincias,
fillOpacity = 0,
weight = 2,
opacity = 1,
label = ~PROVINCIA,
color = "#000000",
group = "Provincias") %>%
addPolygons(data = Anta,
fillOpacity = 0,
weight = 4,
opacity = 1,
label = ~PROVINCIA,
color = "#54278f",
group = "Anta")
# Incendios acumulados por mes
shp   <- 'Materiales/registro_incendios_2000_2018.gpkg'
fires <- st_read(shp) %>%
mutate(Date = paste(`AñO`,
MES_N, 1,
sep = '-')) %>%
group_by(Date) %>%
summarise(nfires = length(Date)) %>%
mutate(Date = as.Date(Date)) %>%
arrange(Date) %>%
as.data.frame() %>%
dplyr::select(-geom)
# Como no todos los meses hay incendios se necesita tener todos los meses para generar el histograma
ts    <- data.frame(Date = seq(as.Date('2000-08-01'),
as.Date('2018-12-01'),
by = 'month')) %>%
full_join(fires)
ts
# Generación del histograma
X <- ggplot(ts, aes(x=Date, y=nfires)) +
geom_bar(stat="identity",
fill="gray",
colour="black") +
theme_bw() +
ylab(label = 'Número de incendios\n') +
xlab(label = '') +
ggtitle(paste('Eventos de incendios \ndel año 2000 al 2018', sep = '')) +
theme(plot.title = element_text(hjust = 0.5, face = 'bold', size=15),
axis.text.x  = element_text(size=11, angle = 75, hjust = 1),
axis.text.y  = element_text(size=11),
axis.title.y = element_text(size = 12, hjust = 0.5, face = 'bold', vjust = 0.5)) +
scale_x_date(limits = c(as.Date('2000-07-01'),
as.Date('2019-01-01')),
date_labels = ("%Y"),
breaks = '1 year') +
scale_y_continuous(breaks = seq(0,500,50))
X
knitr::include_graphics('Img/metodologia_4etapas.jpg')
# Incendios acumulados por mes
shp   <- 'Materiales/registro_incendios_2000_2018.gpkg'
fires <- st_read(shp) %>%
mutate(Date = paste(`AñO`,
MES_N, 1,
sep = '-')) %>%
group_by(Date) %>%
summarise(nfires = length(Date)) %>%
mutate(Date = as.Date(Date)) %>%
arrange(Date) %>%
as.data.frame() %>%
dplyr::select(-geom)
# Como no todos los meses hay incendios se necesita tener todos los meses para generar el histograma
ts    <- data.frame(Date = seq(as.Date('2000-08-01'),
as.Date('2018-12-01'),
by = 'month')) %>%
full_join(fires)
ts
# Generación del histograma
X <- ggplot(ts, aes(x=Date, y=nfires)) +
geom_bar(stat="identity",
fill="gray",
colour="black") +
theme_bw() +
ylab(label = 'Número de incendios\n') +
xlab(label = '') +
ggtitle(paste('Eventos de incendios \ndel año 2000 al 2018', sep = '')) +
theme(plot.title = element_text(hjust = 0.5, face = 'bold', size=15),
axis.text.x  = element_text(size=11, angle = 75, hjust = 1),
axis.text.y  = element_text(size=11),
axis.title.y = element_text(size = 12, hjust = 0.5, face = 'bold', vjust = 0.5)) +
scale_x_date(limits = c(as.Date('2000-07-01'),
as.Date('2019-01-01')),
date_labels = ("%Y"),
breaks = '1 year') +
scale_y_continuous(breaks = seq(0,500,50))
X
fires <- st_read(shp)
peru <- read_sf('Materiales/Peru.gpkg')
Departamentos <- st_read('Materiales/Departamentos.gpkg')
# Extracción de coordenadas de los puntos
fires_df <- st_coordinates(fires) %>% as.data.frame()
names(fires_df) <- c('lon','lat')#here
# Aplicación de la estimación
kde <- kde2d(fires_df$lon, fires_df$lat, n = 250, h = .5, lims = c(-86, -65, -19, 0))
kde_raster <- kde %>% raster() %>% crop(peru) %>% mask(peru)
# image(kde)
# plot(peru, add = T, col = NA)
# Convirtiendolo a raster:
#
# kde_raster <- kde %>% raster()
# kde_raster[kde_raster < 0.05] = NA
# kde_raster[kde_raster >= 0.05] = 1
# writeRaster(kde_raster, 'raster2.tif')
# summary(kde_raster %>% getValues() %>% as_vector())
# Mapa con leaflet
# pal <- colorNumeric(c("#0C2C84", "#41B6C4", "#FFFFCC"), values(kde_raster ), na.color = "transparent")
pal <- colorNumeric(c("#3182bd", "#fec44f", "#f03b20"), values(kde_raster), na.color ="transparent")
leaflet() %>%
addTiles() %>%
addRasterImage(kde_raster, colors = pal) %>%
addLegend(pal = pal, values = values(kde_raster),title = "% Incendios") %>%
addPolygons(data = Departamentos,
fillOpacity = 0,
weight = 2,
opacity = 1,
label = ~DEPARTAMEN,
color = "#000000",
group = "Departamentos")
Provincias <- st_read('Materiales/Provincias.gpkg')
Anta <- st_read('Materiales/Anta.gpkg')
names(Provincias)
kde_raster_clas <- kde_raster
kde_raster_clas[kde_raster < 0.05] = NA
kde_raster_clas[kde_raster >= 0.05] = 1
# writeRaster(kde_raster, 'raster2.tif')
leaflet() %>%
addTiles() %>%
addRasterImage(kde_raster_clas, colors = "#f03b20") %>%
# addLegend(pal = pal, values = values(kde_raster),title = "% Incendios") %>%
addPolygons(data = Provincias,
fillOpacity = 0,
weight = 2,
opacity = 1,
label = ~PROVINCIA,
color = "#000000",
group = "Provincias") %>%
addPolygons(data = Anta,
fillOpacity = 0,
weight = 4,
opacity = 1,
label = ~PROVINCIA,
color = "#54278f",
group = "Anta")
knitr::include_graphics('Img/metodologia_4etapas.jpg')
library(dplyr)
library(ggplot2)
library(tidyverse)
library(sf)
library(rgee)
library(mapedit)
library(raster)
library(cptcity)
library(leaflet)
library(leaflet.extras)
library(MASS)
library(dplyr)
library(tidyverse)
# Incendios acumulados por mes
shp   <- 'Materiales/registro_incendios_2000_2018.gpkg'
fires <- st_read(shp) %>%
mutate(Date = paste(`AñO`,
MES_N, 1,
sep = '-')) %>%
group_by(Date) %>%
summarise(nfires = length(Date)) %>%
mutate(Date = as.Date(Date)) %>%
arrange(Date) %>%
as.data.frame() %>%
dplyr::select(-geom)
# Como no todos los meses hay incendios se necesita tener todos los meses para generar el histograma
ts    <- data.frame(Date = seq(as.Date('2000-08-01'),
as.Date('2018-12-01'),
by = 'month')) %>%
full_join(fires)
ts
# Generación del histograma
X <- ggplot(ts, aes(x=Date, y=nfires)) +
geom_bar(stat="identity",
fill="gray",
colour="black") +
theme_bw() +
ylab(label = 'Número de incendios\n') +
xlab(label = '') +
ggtitle(paste('Eventos de incendios \ndel año 2000 al 2018', sep = '')) +
theme(plot.title = element_text(hjust = 0.5, face = 'bold', size=15),
axis.text.x  = element_text(size=11, angle = 75, hjust = 1),
axis.text.y  = element_text(size=11),
axis.title.y = element_text(size = 12, hjust = 0.5, face = 'bold', vjust = 0.5)) +
scale_x_date(limits = c(as.Date('2000-07-01'),
as.Date('2019-01-01')),
date_labels = ("%Y"),
breaks = '1 year') +
scale_y_continuous(breaks = seq(0,500,50))
X
fires <- st_read(shp)
peru <- read_sf('Materiales/Peru.gpkg')
Departamentos <- st_read('Materiales/Departamentos.gpkg')
# Extracción de coordenadas de los puntos
fires_df <- st_coordinates(fires) %>% as.data.frame()
names(fires_df) <- c('lon','lat')#here
# Aplicación de la estimación
kde <- kde2d(fires_df$lon, fires_df$lat, n = 250, h = .5, lims = c(-86, -65, -19, 0))
kde_raster <- kde %>% raster() %>% crop(peru) %>% mask(peru)
# image(kde)
# plot(peru, add = T, col = NA)
# Convirtiendolo a raster:
#
# kde_raster <- kde %>% raster()
# kde_raster[kde_raster < 0.05] = NA
# kde_raster[kde_raster >= 0.05] = 1
# writeRaster(kde_raster, 'raster2.tif')
# summary(kde_raster %>% getValues() %>% as_vector())
# Mapa con leaflet
# pal <- colorNumeric(c("#0C2C84", "#41B6C4", "#FFFFCC"), values(kde_raster ), na.color = "transparent")
pal <- colorNumeric(c("#3182bd", "#fec44f", "#f03b20"), values(kde_raster), na.color ="transparent")
leaflet() %>%
addTiles() %>%
addRasterImage(kde_raster, colors = pal) %>%
addLegend(pal = pal, values = values(kde_raster),title = "% Incendios") %>%
addPolygons(data = Departamentos,
fillOpacity = 0,
weight = 2,
opacity = 1,
label = ~DEPARTAMEN,
color = "#000000",
group = "Departamentos")
Provincias <- st_read('Materiales/Provincias.gpkg')
Anta <- st_read('Materiales/Anta.gpkg')
names(Provincias)
kde_raster_clas <- kde_raster
kde_raster_clas[kde_raster < 0.05] = NA
kde_raster_clas[kde_raster >= 0.05] = 1
# writeRaster(kde_raster, 'raster2.tif')
leaflet() %>%
addTiles() %>%
addRasterImage(kde_raster_clas, colors = "#f03b20") %>%
# addLegend(pal = pal, values = values(kde_raster),title = "% Incendios") %>%
addPolygons(data = Provincias,
fillOpacity = 0,
weight = 2,
opacity = 1,
label = ~PROVINCIA,
color = "#000000",
group = "Provincias") %>%
addPolygons(data = Anta,
fillOpacity = 0,
weight = 4,
opacity = 1,
label = ~PROVINCIA,
color = "#54278f",
group = "Anta")
knitr::include_graphics('Img/metodologia_4etapas.jpg')
library(dplyr)
library(ggplot2)
library(tidyverse)
library(sf)
library(rgee)
library(mapedit)
library(raster)
library(cptcity)
library(leaflet)
library(leaflet.extras)
library(MASS)
library(dplyr)
library(tidyverse)
# Incendios acumulados por mes
shp   <- 'Materiales/registro_incendios_2000_2018.gpkg'
fires <- st_read(shp) %>%
mutate(Date = paste(`AñO`,
MES_N, 1,
sep = '-')) %>%
group_by(Date) %>%
summarise(nfires = length(Date)) %>%
mutate(Date = as.Date(Date)) %>%
arrange(Date) %>%
as.data.frame() %>%
dplyr::select(-geom)
# Como no todos los meses hay incendios se necesita tener todos los meses para generar el histograma
ts    <- data.frame(Date = seq(as.Date('2000-08-01'),
as.Date('2018-12-01'),
by = 'month')) %>%
full_join(fires)
ts
# Generación del histograma
X <- ggplot(ts, aes(x=Date, y=nfires)) +
geom_bar(stat="identity",
fill="gray",
colour="black") +
theme_bw() +
ylab(label = 'Número de incendios\n') +
xlab(label = '') +
ggtitle(paste('Eventos de incendios \ndel año 2000 al 2018', sep = '')) +
theme(plot.title = element_text(hjust = 0.5, face = 'bold', size=15),
axis.text.x  = element_text(size=11, angle = 75, hjust = 1),
axis.text.y  = element_text(size=11),
axis.title.y = element_text(size = 12, hjust = 0.5, face = 'bold', vjust = 0.5)) +
scale_x_date(limits = c(as.Date('2000-07-01'),
as.Date('2019-01-01')),
date_labels = ("%Y"),
breaks = '1 year') +
scale_y_continuous(breaks = seq(0,500,50))
X
fires <- st_read(shp)
peru <- read_sf('Materiales/Peru.gpkg')
Departamentos <- st_read('Materiales/Departamentos.gpkg')
# Extracción de coordenadas de los puntos
fires_df <- st_coordinates(fires) %>% as.data.frame()
names(fires_df) <- c('lon','lat')#here
# Aplicación de la estimación
kde <- kde2d(fires_df$lon, fires_df$lat, n = 250, h = .5, lims = c(-86, -65, -19, 0))
kde_raster <- kde %>% raster() %>% crop(peru) %>% mask(peru)
# image(kde)
# plot(peru, add = T, col = NA)
# Convirtiendolo a raster:
#
# kde_raster <- kde %>% raster()
# kde_raster[kde_raster < 0.05] = NA
# kde_raster[kde_raster >= 0.05] = 1
# writeRaster(kde_raster, 'raster2.tif')
# summary(kde_raster %>% getValues() %>% as_vector())
# Mapa con leaflet
# pal <- colorNumeric(c("#0C2C84", "#41B6C4", "#FFFFCC"), values(kde_raster ), na.color = "transparent")
pal <- colorNumeric(c("#3182bd", "#fec44f", "#f03b20"), values(kde_raster), na.color ="transparent")
leaflet() %>%
addTiles() %>%
addRasterImage(kde_raster, colors = pal) %>%
addLegend(pal = pal, values = values(kde_raster),title = "% Incendios") %>%
addPolygons(data = Departamentos,
fillOpacity = 0,
weight = 2,
opacity = 1,
label = ~DEPARTAMEN,
color = "#000000",
group = "Departamentos")
Provincias <- st_read('Materiales/Provincias.gpkg')
Anta <- st_read('Materiales/Anta.gpkg')
names(Provincias)
kde_raster_clas <- kde_raster
kde_raster_clas[kde_raster < 0.05] = NA
kde_raster_clas[kde_raster >= 0.05] = 1
# writeRaster(kde_raster, 'raster2.tif')
leaflet() %>%
addTiles() %>%
addRasterImage(kde_raster_clas, colors = "#f03b20") %>%
# addLegend(pal = pal, values = values(kde_raster),title = "% Incendios") %>%
addPolygons(data = Provincias,
fillOpacity = 0,
weight = 2,
opacity = 1,
label = ~PROVINCIA,
color = "#000000",
group = "Provincias") %>%
addPolygons(data = Anta,
fillOpacity = 0,
weight = 4,
opacity = 1,
label = ~PROVINCIA,
color = "#54278f",
group = "Anta")
# Incendios acumulados por mes
shp   <- 'Materiales/registro_incendios_2000_2018.gpkg'
fires <- st_read(shp) %>%
mutate(Date = paste(`AñO`,
MES_N, 1,
sep = '-')) %>%
group_by(Date) %>%
summarise(nfires = length(Date)) %>%
mutate(Date = as.Date(Date)) %>%
arrange(Date) %>%
as.data.frame() %>%
dplyr::select(-geom)
# Como no todos los meses hay incendios se necesita tener todos los meses para generar el histograma
ts    <- data.frame(Date = seq(as.Date('2000-08-01'),
as.Date('2018-12-01'),
by = 'month')) %>%
full_join(fires)
ts
# Generación del histograma
X <- ggplot(ts, aes(x=Date, y=nfires)) +
geom_bar(stat="identity",
fill="gray",
colour="black") +
theme_bw() +
ylab(label = 'Número de incendios\n') +
xlab(label = '') +
ggtitle(paste('Eventos de incendios \ndel año 2000 al 2018', sep = '')) +
theme(plot.title = element_text(hjust = 0.5, face = 'bold', size=15),
axis.text.x  = element_text(size=11, angle = 75, hjust = 1),
axis.text.y  = element_text(size=11),
axis.title.y = element_text(size = 12, hjust = 0.5, face = 'bold', vjust = 0.5)) +
scale_x_date(limits = c(as.Date('2000-07-01'),
as.Date('2019-01-01')),
date_labels = ("%Y"),
breaks = '1 year') +
scale_y_continuous(breaks = seq(0,500,50))
X
knitr::include_graphics('Img/metodologia_4etapas.jpg')
library(dplyr)
library(ggplot2)
library(tidyverse)
library(sf)
library(rgee)
library(mapedit)
library(raster)
library(cptcity)
library(leaflet)
library(leaflet.extras)
library(MASS)
library(dplyr)
library(tidyverse)
knitr::include_graphics('Img/histograma_incendios.jpg')
fires <- st_read(shp)
peru <- read_sf('Materiales/Peru.gpkg')
Departamentos <- st_read('Materiales/Departamentos.gpkg')
# Extracción de coordenadas de los puntos
fires_df <- st_coordinates(fires) %>% as.data.frame()
names(fires_df) <- c('lon','lat')#here
# Aplicación de la estimación
kde <- kde2d(fires_df$lon, fires_df$lat, n = 250, h = .5, lims = c(-86, -65, -19, 0))
kde_raster <- kde %>% raster() %>% crop(peru) %>% mask(peru)
# image(kde)
# plot(peru, add = T, col = NA)
# Convirtiendolo a raster:
#
# kde_raster <- kde %>% raster()
# kde_raster[kde_raster < 0.05] = NA
# kde_raster[kde_raster >= 0.05] = 1
# writeRaster(kde_raster, 'raster2.tif')
# summary(kde_raster %>% getValues() %>% as_vector())
# Mapa con leaflet
# pal <- colorNumeric(c("#0C2C84", "#41B6C4", "#FFFFCC"), values(kde_raster ), na.color = "transparent")
pal <- colorNumeric(c("#3182bd", "#fec44f", "#f03b20"), values(kde_raster), na.color ="transparent")
leaflet() %>%
addTiles() %>%
addRasterImage(kde_raster, colors = pal) %>%
addLegend(pal = pal, values = values(kde_raster),title = "% Incendios") %>%
addPolygons(data = Departamentos,
fillOpacity = 0,
weight = 2,
opacity = 1,
label = ~DEPARTAMEN,
color = "#000000",
group = "Departamentos")
Provincias <- st_read('Materiales/Provincias.gpkg')
Anta <- st_read('Materiales/Anta.gpkg')
names(Provincias)
kde_raster_clas <- kde_raster
kde_raster_clas[kde_raster < 0.05] = NA
kde_raster_clas[kde_raster >= 0.05] = 1
# writeRaster(kde_raster, 'raster2.tif')
leaflet() %>%
addTiles() %>%
addRasterImage(kde_raster_clas, colors = "#f03b20") %>%
# addLegend(pal = pal, values = values(kde_raster),title = "% Incendios") %>%
addPolygons(data = Provincias,
fillOpacity = 0,
weight = 2,
opacity = 1,
label = ~PROVINCIA,
color = "#000000",
group = "Provincias") %>%
addPolygons(data = Anta,
fillOpacity = 0,
weight = 4,
opacity = 1,
label = ~PROVINCIA,
color = "#54278f",
group = "Anta")
